# Enable Rewrite Engine
RewriteEngine On
RewriteBase /

# Prevent access to sensitive files
<FilesMatch "\.(sql|log|md)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Allow direct access to existing files and directories
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Route /admin to admin login
RewriteCond %{REQUEST_URI} ^/admin/?$
RewriteRule ^admin/?$ admin_login.php [L]

# Route /login to user login (otp_login.php)
RewriteCond %{REQUEST_URI} ^/login/?$
RewriteRule ^login/?$ auth/otp_login.php [L]

# Route /dashboard/* requests to dashboard router (only if not a real file)
RewriteCond %{REQUEST_URI} ^/dashboard/(.+)$
RewriteRule ^dashboard/(.+)$ dashboard/router.php?route=$1 [L,QSA]

# Route /dashboard to dashboard router (empty route)
RewriteCond %{REQUEST_URI} ^/dashboard/?$
RewriteRule ^dashboard/?$ dashboard/router.php?route= [L,QSA]

# Standard directory index
DirectoryIndex index.php index.html

