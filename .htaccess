# Enable Rewrite Engine
RewriteEngine On
RewriteBase /

# Prevent access to sensitive files
<FilesMatch "\.(sql|log|md)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Route /admin to admin login (must be before file/directory check)
RewriteCond %{REQUEST_URI} ^/admin/?$
RewriteRule ^admin/?$ admin_login.php [L]

# Route /login to user login
RewriteCond %{REQUEST_URI} ^/login/?$
RewriteRule ^login/?$ auth/otp_login.php [L]

# Route /dashboard to dashboard router (empty route)
RewriteCond %{REQUEST_URI} ^/dashboard/?$
RewriteRule ^dashboard/?$ dashboard/router.php?route= [L,QSA]

# Route /dashboard/* requests to dashboard router (exclude auth directory)
RewriteCond %{REQUEST_URI} ^/dashboard/(.+)$
RewriteCond %{REQUEST_URI} !^/dashboard/auth/
RewriteRule ^dashboard/(.+)$ dashboard/router.php?route=$1 [L,QSA]

# Allow direct access to existing files and directories (after routing rules)
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Standard directory index
DirectoryIndex index.php index.html

